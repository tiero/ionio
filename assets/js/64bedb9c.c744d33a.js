"use strict";(self.webpackChunkionio_website=self.webpackChunkionio_website||[]).push([[548],{3905:function(t,e,n){n.d(e,{Zo:function(){return p},kt:function(){return h}});var o=n(7294);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,o,a=function(t,e){if(null==t)return{};var n,o,a={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var c=o.createContext({}),l=function(t){var e=o.useContext(c),n=e;return t&&(n="function"==typeof t?t(e):r(r({},e),t)),n},p=function(t){var e=l(t.components);return o.createElement(c.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return o.createElement(o.Fragment,{},e)}},d=o.forwardRef((function(t,e){var n=t.components,a=t.mdxType,i=t.originalType,c=t.parentName,p=s(t,["components","mdxType","originalType","parentName"]),d=l(n),h=a,m=d["".concat(c,".").concat(h)]||d[h]||u[h]||i;return n?o.createElement(m,r(r({ref:e},p),{},{components:n})):o.createElement(m,r({ref:e},p))}));function h(t,e){var n=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var i=n.length,r=new Array(i);r[0]=d;var s={};for(var c in e)hasOwnProperty.call(e,c)&&(s[c]=e[c]);s.originalType=t,s.mdxType="string"==typeof t?t:a,r[1]=s;for(var l=2;l<i;l++)r[l]=n[l];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7689:function(t,e,n){n.r(e),n.d(e,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return p},default:function(){return d}});var o=n(7462),a=n(3366),i=(n(7294),n(3905)),r=["components"],s={},c="Bitcoin Script",l={unversionedId:"language/BitcoinScript",id:"language/BitcoinScript",title:"Bitcoin Script",description:"Ivy is designed to make it easier to create smart contracts for the Bitcoin network. Bitcoin's protocol works very differently from other blockchain protocols that support smart contracts, such as Ethereum, and the types of contracts that are supported are more limited. Despite those limitations, Bitcoin smart contracts have proven to be surprisingly flexible, supporting applications such as payment channels, cross-chain atomic trades, and more. Future protocol upgrades\u2014and improvements in tooling\u2014may make it possible to build increasingly sophisticated applications on top of Bitcoin.",source:"@site/docs/language/BitcoinScript.md",sourceDirName:"language",slug:"/language/BitcoinScript",permalink:"/docs/language/BitcoinScript",editUrl:"https://github.com/ionio-lang/ionio/tree/main/website/docs/language/BitcoinScript.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Ivy Language",permalink:"/docs/language/"},next:{title:"Example Contracts",permalink:"/docs/language/ExampleContracts"}},p=[{value:"Bitcoin contracts",id:"bitcoin-contracts",children:[],level:2},{value:"Bitcoin transactions",id:"bitcoin-transactions",children:[],level:2},{value:"Bitcoin addresses",id:"bitcoin-addresses",children:[],level:2},{value:"Bitcoin Script",id:"bitcoin-script-1",children:[],level:2}],u={toc:p};function d(t){var e=t.components,n=(0,a.Z)(t,r);return(0,i.kt)("wrapper",(0,o.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"bitcoin-script"},"Bitcoin Script"),(0,i.kt)("p",null,"Ivy is designed to make it easier to create smart contracts for the Bitcoin network. Bitcoin's protocol works very differently from other blockchain protocols that support smart contracts, such as Ethereum, and the types of contracts that are supported are more limited. Despite those limitations, Bitcoin smart contracts have proven to be surprisingly flexible, supporting applications such as payment channels, cross-chain atomic trades, and more. Future protocol upgrades\u2014and improvements in tooling\u2014may make it possible to build increasingly sophisticated applications on top of Bitcoin."),(0,i.kt)("p",null,"The below sections provide some background on how Bitcoin transactions, addresses, and scripting work, glossing over some important details. If you would like to learn about these topics, you can check out ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/bitcoinbook/bitcoinbook"},"Mastering Bitcoin"),", by Andreas Antonopoulos."),(0,i.kt)("p",null,"These explanations also assume that you are familiar with the basic concept of a distributed ledger, as well as digital signatures and hash functions. For more background on those concepts, you can check out ",(0,i.kt)("a",{parentName:"p",href:"https://blog.chain.com/behind-the-magic-of-the-blockchain-48f1cb35f1dc"},"this introductory post")," from the Chain blog."),(0,i.kt)("h2",{id:"bitcoin-contracts"},"Bitcoin contracts"),(0,i.kt)("p",null,"The primary responsibility of the Bitcoin network is to maintain a distributed ledger, meaning information about who controls each of the over 16 million (at the time of this writing) Bitcoins in existence."),(0,i.kt)("p",null,"You can think of the current state of the ledger as a set of lockboxes, each of which stores some value (i.e., 1000 BTC, 5 BTC, or .001 BTC) and is controlled by some ",(0,i.kt)("a",{parentName:"p",href:"#bitcoin-addresses"},(0,i.kt)("em",{parentName:"a"},"address"))," (i.e., 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa)."),(0,i.kt)("p",null,'In the Bitcoin context, these lockboxes are usually referred to as "unspent transaction outputs." In Ivy, we call them ',(0,i.kt)("em",{parentName:"p"},"contracts"),"."),(0,i.kt)("h2",{id:"bitcoin-transactions"},"Bitcoin transactions"),(0,i.kt)("p",null,"Each Bitcoin transaction unlocks value from some set of contracts (or creates new value from thin air, in the case of a ",(0,i.kt)("a",{parentName:"p",href:"https://bitcoin.org/en/glossary/coinbase-transaction"},"coinbase transaction"),"), and locks that value into newly created contracts. The old contracts, once unlocked, are removed from the ledger state; there is no way to withdraw only part of the value from a contract, or change a contract's state. In other words, in Bitcoin, contracts are ",(0,i.kt)("em",{parentName:"p"},"immutable"),"."),(0,i.kt)("p",null,"A transaction contains a list of ",(0,i.kt)("em",{parentName:"p"},"inputs"),"\u2014the unspent contracts that the transaction wants to unlock\u2014and a list of ",(0,i.kt)("em",{parentName:"p"},"outputs"),"\u2014the new contracts that the contract wants to create. The amount of value unlocked in the inputs must be equal to the amount of value locked in the outputs."),(0,i.kt)("p",null,"For more on Bitcoin transactions, you can check out Chapter 6 of Mastering Bitcoin, ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/bitcoinbook/bitcoinbook/blob/second_edition/ch06.asciidoc"},"Transactions"),"."),(0,i.kt)("h2",{id:"bitcoin-addresses"},"Bitcoin addresses"),(0,i.kt)("p",null,"Bitcoin wouldn't provide much security if anyone were able to unlock any contract. Contracts can only be unlocked under certain conditions, specified in that contract's ",(0,i.kt)("em",{parentName:"p"},"address"),". For example, an address can specify that the contract can only be unlocked using a digital signature from the contract's owner (or more specifically, by the private key corresponding to a prespecified public key)."),(0,i.kt)("p",null,"Each Bitcoin address corresponds to a program.",(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," When you send Bitcoin to an address, you are creating a contract which locks that Bitcoin up with that address's program. The only way to spend that Bitcoin is to satisfy the program, thus unlocking the value and allowing it to be sent to a new address. "),(0,i.kt)("p",null,"When spending a contract, the user provides some arguments to satisfy the contract's program. For example, the arguments might include one or more signatures, or the preimage of a particular hash. In Ivy, these arguments are referred to as ",(0,i.kt)("em",{parentName:"p"},"clause arguments"),", since they are provided at the time that a particular clause of the contract is invoked."),(0,i.kt)("h2",{id:"bitcoin-script-1"},"Bitcoin Script"),(0,i.kt)("p",null,"Bitcoin Script is the low-level language that contracts' programs are written in. It consists of a sequence of opcodes, which are executed in order by a stack-based virtual machine (after the provided clause arguments are first placed on the stack)."),(0,i.kt)("p",null,"Bitcoin Script is a relatively simple language, with support for cryptographic and hash operations, as well as conditionals. It is not Turing-complete (since it has no support for looping or recursion). It also does not allow scripts to inspect other inputs or outputs in the transaction, meaning the contract cannot control the flow of value or maintain any kind of persistent state.",(0,i.kt)("sup",{parentName:"p",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))),(0,i.kt)("p",null,"Developers already use Bitcoin Script to create multisignature Bitcoin addresses and time-locked transactions, as well as more complex protocols like payment channels and cross-chain atomic trades. But reading and writing programs using Bitcoin Script is difficult, as is using it to create addresses and transactions. The goal of Ivy is to make it easier to write and instantiate these programs."),(0,i.kt)("p",null,"For more on Bitcoin Script, you can check out the ",(0,i.kt)("a",{parentName:"p",href:"https://en.bitcoin.it/wiki/Script"},"Bitcoin Wiki")," as well as Chapter 7 of Mastering Bitcoin, ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/bitcoinbook/bitcoinbook/blob/second_edition/ch07.asciidoc"},"Advanced Transactions and Scripting")),(0,i.kt)("div",{className:"footnotes"},(0,i.kt)("hr",{parentName:"div"}),(0,i.kt)("ol",{parentName:"div"},(0,i.kt)("li",{parentName:"ol",id:"fn-1"},"Conversion between Bitcoin Script programs and Bitcoin addresses involves some technical details that are beyond the scope of this documentation. The Ivy compiler creates ",(0,i.kt)("em",{parentName:"li"},"Segregated Witness"),' (SegWit) addresses, a new kind of Bitcoin address that has been supported since a protocol upgrade in August 2017. To create a SegWit address, the bytecode of the program\u2014the "witness script"\u2014is hashed to create a "redeem script," which is in turn hashed to create the address. To spend from a SegWit address, both the redeem script and the witness script are revealed, and arguments are provided to satisfy the witness script. For more on how SegWit addresses and scripts work, see the ',(0,i.kt)("a",{parentName:"li",href:"https://bitcoincore.org/en/segwit_wallet_dev/"},"Segregated Witness Wallet Development Guide")," from Bitcoin Core.",(0,i.kt)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-2"},"The inability to directly control value is a major difference when compiling Ivy to Bitcoin rather than using the version of ",(0,i.kt)("a",{parentName:"li",href:"https://www.chain.com/ivy"},"Ivy")," designed to write smart contracts for Chain Core. There have been several proposals to add this kind of functionality to Bitcoin Script, most notably in ",(0,i.kt)("a",{parentName:"li",href:"http://fc16.ifca.ai/bitcoin/papers/MES16.pdf"},"Bitcoin Covenants"),", by Malte M\xf6ser, Ittay Eyal, and Emin G\xfcn Sirer.",(0,i.kt)("a",{parentName:"li",href:"#fnref-2",className:"footnote-backref"},"\u21a9")))))}d.isMDXComponent=!0}}]);